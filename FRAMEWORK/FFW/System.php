<?php/*    Copyright (C) 2018  Fred Ciabattoni - ProjectOverground v1.0    http://projectoverground.com/    This program is free software: you can redistribute it and/or modify    it under the terms of the GNU General Public License as published by    the Free Software Foundation, either version 3 of the License, or    (at your option) any later version.    This program is distributed in the hope that it will be useful,    but WITHOUT ANY WARRANTY; without even the implied warranty of    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    GNU General Public License for more details.    You should have received a copy of the GNU General Public License    along with this program.  If not, see <http://www.gnu.org/licenses/>.*/namespace FFW;use FFW\PHP\Location;class System{    public $globalVars;    public $serverVars;    public $systemVars;    public $sessionVars;    public $getVars;    public $postVars;    public $pages;    public $protectVars;    public function __construct(){        $this->systemVars = $this->getSystemVars();        if(isset($_GET['sec'])){            $this->pages = explode('/',$_GET['sec'] );            $get = $this->systemVars['get'];                        if(sizeof($get) > 0){                if(isset($get[$this->pages[0]])){                    $get = $get[$this->pages[0]];                }else{                    $get = $get['main'];                }                if(sizeof($get) > 0) {                    foreach ($this->pages as $key => $value) {                        if (isset($get[$key])) {                            $_GET[$get[$key]] = $value;                        }                    }                }            }        }        $this->globalVars = $this->getGlobalVars();        $this->serverVars = $this->getServerVars();        $this->sessionVars = $this->getSessionVars();        $this->getVars = $this->getGetVars();        $this->postVars = $this->getPostVars();        $this->protectVars = $this->getProtectionVars();        $this->devCheck();    }    private function devCheck()    {        if($this->systemVars['development']['set']) {            if (!in_array($this->serverVars["REMOTE_ADDR"], $this->systemVars['development']['IP'])) {                return new Location($this->systemVars['development']['RedirectAddress'], $this->systemVars['development']['Status']);            }        }    }    private function getPostVars()    {        return $_POST;    }    private function getGetVars()    {        return $_GET;    }    private function getSessionVars()    {        return include BASE_DIR.'/VARS/sessionVars.php';    }    private function getSystemVars()    {        return include BASE_DIR.'/VARS/systemVars.php';    }    private function getServerVars()    {        return include BASE_DIR.'/VARS/serverVars.php';    }    private function getGlobalVars()    {        return include BASE_DIR.'/VARS/globalVars.php';    }    private function getProtectionVars()    {        return include BASE_DIR.'/VARS/protection.php';    }    public function loadEnginePage($get,$post,$global,$server,$system)    {        $content = '';        $arrProtect = $this->protectVars;        $arrIP = $arrProtect['IP'];        if (in_array($_SERVER['REMOTE_ADDR'], $arrIP)) {            new Location('/s.html','HTTP/1.0 404 Not Found');        }        if(isset($this->pages[0])) {            if (file_exists(BASE_DIR . '/SITE/' . $this->pages[0] . '/engine/default.php')) {                $content = include BASE_DIR . '/SITE/' . $this->pages[0] . '/engine/default.php';            } else if (file_exists(BASE_DIR . '/SITE/main/engine/' . $this->pages[0] . '.php')) {                $content = include BASE_DIR . '/SITE/main/engine/' . $this->pages[0] . '.php';            } else {                new Location('/404','HTTP/1.0 404 Not Found');            }        }else{            $content = include BASE_DIR.'/SITE/main/engine/default.php';        }        return $content;    }    public function loadEngine($get,$post,$global,$server,$system)    {        $arrMainContent = include BASE_DIR . '/SITE/main/global.php';        $content = $this->loadEnginePage($get,$post,$global,$server,$system);        return array('content' => $content,'arrMainContent' => $arrMainContent);    }}?>